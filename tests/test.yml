---
engine: 'sqlite:///:memory:'

ingest:
  # Example of space separated log output
  data: 'L(?P=<time>\S+)(?P=<time_response>\S+)(?P=<mac_source>\S+)(?P=<ip_source>\S+)(?P=<squid_request_status>\S+)(?P=<http_status_code>\S+)(?P=<http_reply_size>\S+)(?P=<http_request_method>\S+)(?P=<http_request_url>\S+)(?P=<user_name>\S+)(?P=<squid_hier_code>\S+)(?P=<ip_destination>\S+)(?P=<http_content_type>\S+)'
  rotate: 'R'
  truncate: 'T'
  reopen: 'O'
  flush: 'F'
  rotatecount: 'r(\d+)'
  bufferoutput: 'b(\d)'

process:
  data:
    action: store
    tablename: access_logs
    pk: id
    schema:
      id: Integer
      time: DateTime
      time_response: String
      mac_source: String
      ip_source: String
      squid_request_status: String
      http_status_code: String
      http_reply_size: Integer
      http_request_method: String
      http_request_url: String
      user_name: String
      squid_hier_code: String
      ip_destination: String
      http_content_type: String
  rotate:
    action: drop
  truncate:
    action: drop
  reopen:
    action: drop
  flush:
    action: drop
  rotatecount:
    action: drop
  bufferoutput:
    action: drop